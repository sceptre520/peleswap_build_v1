(this["webpackJsonpzilswap-webapp"]=this["webpackJsonpzilswap-webapp"]||[]).push([[14],{2010:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(7),a=(n(0),n(1945)),r=n(1998),i=n(1),c=Object(a.a)((function(e){var t;return{root:(t={flex:1,padding:e.spacing(8,0,2)},Object(o.a)(t,e.breakpoints.down("sm"),{padding:e.spacing(6,0,2)}),Object(o.a)(t,e.breakpoints.down("xs"),{padding:e.spacing(6,2,2)}),t)}})),s=function(e){var t=e.children,n=c();return Object(i.jsx)(r.a,{className:n.root,children:t})}},2015:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return K}));var o,a=n(7),r=n(3),i=n(2),c=n.n(i),s=n(20),l=n(12),d=n(26),b=n(0),u=n(1968),p=n(1998),j=n(121),f=n(1903),m=n(1909),h=n(1956),O=n(1954),g=n(1945),x=n(86),v=n(28),y=n.n(v),w=n(10),k=n.n(w),B=n(18),N=n(61),T=n(67),C=n(34),S=n(2010),F=n(43),E=n(9),I=n(22),P=n(47),L=n(21),A=["title","titleId"];function D(){return(D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function R(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function W(e,t){var n=e.title,a=e.titleId,r=R(e,A);return b.createElement("svg",D({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},r),n?b.createElement("title",{id:a},n):null,o||(o=b.createElement("path",{d:"M16.6663 5L7.49967 14.1667L3.33301 10",stroke:"black",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})))}var z=b.forwardRef(W),M=(n.p,n(1)),X=["className"],q=Object(g.a)((function(e){var t;return{root:(t={},Object(a.a)(t,e.breakpoints.down("xs"),{padding:0}),Object(a.a)(t,"display","flex"),Object(a.a)(t,"flexDirection","column"),Object(a.a)(t,"justifyContent","center"),Object(a.a)(t,"alignItems","center"),t),container:{maxWidth:"680px",width:"100%",display:"row"},contentBox:Object(a.a)({display:"flex"},e.breakpoints.down("sm"),{width:"100%",flexDirection:"column-reverse"}),nftBox:Object(a.a)({marginLeft:e.spacing(6)},e.breakpoints.down("sm"),{width:"100%",marginLeft:0}),nftCard:{maxWidth:"none"},description:{"& .MuiTypography-root":{marginBottom:6,textTransform:"uppercase"},"& .MuiInputBase-input":{height:"80px !important"}},label:{fontSize:"18px",color:"dark"===e.palette.type?"#DEFFFF":"#0D1B24",fontWeight:"bold",width:150,overflowX:"visible",textTransform:"uppercase",marginBottom:1},instruction:Object(a.a)({color:"dark"===e.palette.type?"#DEFFFF":"#0D1B24",fontSize:12,margin:0,opacity:.5},e.breakpoints.up("sm"),{width:400}),saleTypeButton:{padding:20,borderRadius:12,backgroundColor:"rgba(255,255,255,0.1)",flexGrow:1,outline:"none",border:"none",color:"dark"===e.palette.type?"#DEFFFF":"#0D1B24",fontWeight:"bold",cursor:"pointer"},saleTypeButtonSelected:{backgroundColor:"#37f2f0",color:"#003340"},actionButton:{height:58,marginTop:24},feeLabel:{fontWeight:"bold",flexGrow:1,fontSize:"14px"},feeValue:{fontWeight:"bold",fontSize:"14px"},dialogRoot:{"& .MuiDialogTitle-root":{padding:e.spacing(4.5,4.5,5),"& .MuiTypography-root":{fontFamily:"'Raleway', sans-serif",fontWeight:700,fontSize:"24px"},"& .MuiSvgIcon-root":{fontSize:"1.8rem"},"& .MuiIconButton-root":{top:"21px",right:"21px"}},position:"relative"},dialogContent:Object(a.a)({backgroundColor:e.palette.background.default,borderLeft:e.palette.border,borderRight:e.palette.border,borderBottom:e.palette.border,borderRadius:"0 0 12px 12px",padding:e.spacing(0,4.5,5)},e.breakpoints.up("sm"),{width:436}),dialogButton:{height:42,marginTop:6},progress:{position:"absolute"},step:{width:110,height:52,borderRadius:26,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#223139",marginRight:24,position:"relative",maxWidth:54.5,minWidth:53.75},stepLabel:{fontWeight:"bold",fontSize:14,marginBottom:2},stepActive:{backgroundColor:"#EEBF43",color:"#003340"},stepCompleted:{backgroundColor:"#37f2f0",color:"#003340"},stepBar:{position:"absolute",top:50,left:25,height:44,width:6,backgroundColor:"#223139",backgroundImage:"linear-gradient(#EEBF43, #223139)",zIndex:0},stepBarFirstStepCompleted:{backgroundImage:"linear-gradient(#37f2f0, #EEBF43)"},stepBarCompleted:{backgroundImage:"linear-gradient(#37f2f0, #37f2f0)"},breakWord:{wordBreak:"break-word"}}})),K=function(e){var t,n,o,i,g,v,w,A=e.className,D=Object(d.a)(e,X),R=q(),W=Object(B.c)(F.a).network,K=Object(B.c)(F.g).wallet,_=Object(B.c)(F.e),G=Object(B.c)(F.c).exchangeInfo,V=Object(E.B)(),H=Object(N.n)(),J=Object(b.useState)(!1),U=Object(l.a)(J,2),Z=U[0],$=U[1],Q=Object(b.useState)(0),Y=Object(l.a)(Q,2),ee=Y[0],te=Y[1],ne=Object(E.o)("confirmSell",(function(){return $(!1)})),oe=Object(l.a)(ne,3),ae=oe[0],re=oe[1],ie=oe[2],ce=Object(E.o)("runGetNFTDetails"),se=Object(l.a)(ce,1)[0],le=Object(b.useState)(),de=Object(l.a)(le,2),be=de[0],ue=de[1],pe=Object(b.useState)(!1),je=Object(l.a)(pe,2),fe=je[0],me=je[1],he=Object(E.z)(),Oe=Object(b.useState)({description:"",saleType:"fixed_price",sellToken:_.tokens[L.D],buyNowPrice:"0",startingPrice:"0",reservePrice:"0"}),ge=Object(l.a)(Oe,2),xe=ge[0],ve=ge[1],ye=Object(b.useState)(!1),we=Object(l.a)(ye,2),ke=we[0],Be=we[1],Ne=Object(b.useState)(!1),Te=Object(l.a)(Ne,2),Ce=Te[0],Se=Te[1],Fe=Object(N.k)(),Ee=H.params.collection,Ie=H.params.id,Pe=Object(b.useMemo)((function(){var e,t,n;return(null===be||void 0===be||null===(e=be.owner)||void 0===e?void 0:e.address)&&(null===K||void 0===K||null===(t=K.addressInfo.byte20)||void 0===t?void 0:t.toLowerCase())===(null===be||void 0===be||null===(n=be.owner)||void 0===n?void 0:n.address)}),[be,null===K||void 0===K?void 0:K.addressInfo]);Object(b.useEffect)((function(){K&&Le()}),[K]);var Le=function(e){se(Object(s.a)(c.a.mark((function e(){var t,n,o,a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new I.b(W),n=Object(x.fromBech32Address)(Ee).toLowerCase(),o=null===K||void 0===K?void 0:K.addressInfo.byte20.toLocaleLowerCase(),e.next=5,t.getNftToken(n,Ie,o);case 5:a=e.sent,r=a.result,ue(r.model);case 8:case"end":return e.stop()}}),e)}))))},Ae=function(e){ve(Object(r.a)(Object(r.a)({},xe),{},{sellToken:e}))},De=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0";ve(Object(r.a)(Object(r.a)({},xe),{},Object(a.a)({},e,t)))},Re=function(e){var t,n,o=new y.a(xe[e]).decimalPlaces(null!==(t=null===(n=xe.sellToken)||void 0===n?void 0:n.decimals)&&void 0!==t?t:0);(o.isNaN()||o.isNegative()||!o.isFinite())&&ve(Object(r.a)(Object(r.a)({},xe),{},Object(a.a)({},e,"0")))},We=Object(b.useMemo)((function(){if(!xe.sellToken)return T.BN_ZERO;var e=Object(E.b)(xe.buyNowPrice).shiftedBy(xe.sellToken.decimals);return V.usd(_,xe.sellToken.address,e.toString(10))}),[xe,V,_]);return Pe?Object(M.jsx)(S.a,Object(r.a)(Object(r.a)({},D),{},{children:Object(M.jsxs)(u.a,{className:k()(R.root,A),children:[Object(M.jsxs)(p.a,{className:R.container,children:[Object(M.jsx)(p.a,{justifyContent:"flex-start",marginBottom:4,children:Object(M.jsx)(j.a,{variant:"h1",children:"Sell"})}),Object(M.jsxs)(p.a,{className:R.contentBox,children:[Object(M.jsxs)(p.a,{children:["fixed_price"===xe.saleType&&Object(M.jsxs)(p.a,{display:"flex",flexDirection:"column",marginTop:2,children:[Object(M.jsx)(f.a,{shrink:!0,focused:!1,className:k()(Object(a.a)({},R.label,!0)),children:"Buy Now Price"}),Object(M.jsx)(m.a,{className:R.instruction,children:'Transactions will be made automatically once the buyer hits "Confirm".'}),Object(M.jsx)(p.a,{marginTop:1,children:Object(M.jsx)(C.E,{token:null!==(t=xe.sellToken)&&void 0!==t?t:null,amount:xe.buyNowPrice,tokenList:"ark-zil",hideBalance:!0,onEditorBlur:function(){return Re("buyNowPrice")},onAmountChange:function(e){return De("buyNowPrice",e)},onCurrencyChange:Ae})}),Object(M.jsxs)(C.ib,{variant:"body2",align:"left",marginTop:1,marginLeft:2,children:["\u2248 $",Object(E.i)(We,2)]})]}),"timed_auction"===xe.saleType&&Object(M.jsxs)(M.Fragment,{children:[Object(M.jsxs)(p.a,{display:"flex",flexDirection:"column",marginTop:4,children:[Object(M.jsx)(f.a,{shrink:!0,focused:!1,className:k()(Object(a.a)({},R.label,!0)),children:"Starting Price"}),Object(M.jsx)(m.a,{className:R.instruction,children:"Set a minimum bid XXXXXXXXX"}),Object(M.jsx)(p.a,{marginTop:1,children:Object(M.jsx)(C.E,{token:null!==(n=xe.sellToken)&&void 0!==n?n:null,amount:xe.buyNowPrice,onEditorBlur:function(){return Re("startingPrice")},onAmountChange:function(e){return De("startingPrice",e)},onCurrencyChange:Ae})})]}),Object(M.jsxs)(p.a,{display:"flex",flexDirection:"column",marginTop:4,children:[Object(M.jsx)(f.a,{shrink:!0,focused:!1,className:k()(Object(a.a)({},R.label,!0)),children:"Reserve Price"}),Object(M.jsx)(m.a,{className:R.instruction,children:"If no bid hits the reserve price, your auction will close without a sale."}),Object(M.jsx)(p.a,{marginTop:1,children:Object(M.jsx)(C.E,{label:"Reserve Price",token:null!==(o=xe.sellToken)&&void 0!==o?o:null,amount:xe.buyNowPrice,onEditorBlur:function(){return Re("reservePrice")},onAmountChange:function(e){return De("reservePrice",e)},onCurrencyChange:Ae})})]}),Object(M.jsxs)(p.a,{display:"flex",flexDirection:"column",marginTop:4,children:[Object(M.jsx)(f.a,{shrink:!0,focused:!1,className:k()(Object(a.a)({},R.label,!0)),children:"End Auction On"}),Object(M.jsx)(m.a,{className:R.instruction,children:"Choose when to end your timed auction."})]})]}),Object(M.jsx)(C.h,{label:"Offer Expiry",onExpiryChange:function(e){te(e)}}),Object(M.jsxs)(p.a,{display:"flex",flexDirection:"column",marginTop:4,children:[Object(M.jsx)(f.a,{shrink:!0,focused:!1,className:k()(Object(a.a)({},R.label,!0)),children:"Fees"}),Object(M.jsx)(m.a,{className:R.instruction,children:"The following fees will be deducted once this NFT is sold."}),(null===G||void 0===G?void 0:G.baseFeeBps)&&Object(M.jsxs)(p.a,{display:"flex",marginTop:1,children:[Object(M.jsx)(j.a,{className:R.feeLabel,children:"Service Fee"}),Object(M.jsxs)(j.a,{className:R.feeValue,children:[G.baseFeeBps/100,"%"]})]}),(null===be||void 0===be?void 0:be.collection)&&null!==be.collection.royaltyBps&&Object(M.jsxs)(p.a,{display:"flex",marginTop:1,children:[Object(M.jsx)(j.a,{className:R.feeLabel,children:"Royalties"}),Object(M.jsxs)(j.a,{className:R.feeValue,children:[new y.a(be.collection.royaltyBps).shiftedBy(-2).toString(),"%"]})]})]}),ie&&Object(M.jsxs)(C.ib,{marginTop:2,className:R.breakWord,color:"error",children:["Error: ",null!==(i=null===ie||void 0===ie?void 0:ie.message)&&void 0!==i?i:"Unknown error"]}),Object(M.jsx)(C.K,{className:R.actionButton,loading:re,disabled:!new y.a(xe.buyNowPrice).gt(0),variant:"contained",color:"primary",onClick:function(){var e,t;(null===K||void 0===K?void 0:K.provider)&&(null===(e=H.params)||void 0===e?void 0:e.collection)&&(null===(t=H.params)||void 0===t?void 0:t.id)&&xe.sellToken&&"0"!==xe.buyNowPrice&&G&&ae(Object(s.a)(c.a.mark((function e(){var t,n,o,a,r,i,s,l,d,b,u,p,j,f,m,h,O,g,v,w,k,B,N;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=H.params,a=o.collection,r=o.id,i=new y.a(xe.buyNowPrice).shiftedBy(xe.sellToken.decimals),(s={amount:i,address:Object(x.fromBech32Address)(xe.sellToken.address)}).address!==(null===be||void 0===be||null===(t=be.bestAsk)||void 0===t?void 0:t.price.address)||!s.amount.gte(be.bestAsk.price.amount)){e.next=8;break}throw d=_.tokens[xe.sellToken.address],b=null!==(l=null===d||void 0===d?void 0:d.decimals)&&void 0!==l?l:0,u=Object(E.b)(be.bestAsk.price.amount).decimalPlaces(0).shiftedBy(-b),new Error("Selling price should be lower than existing price of ".concat(u.toFormat()," ").concat(null===d||void 0===d?void 0:d.symbol));case 8:if("number"===typeof(null===be||void 0===be||null===(n=be.collection)||void 0===n?void 0:n.royaltyBps)){e.next=10;break}throw new Error("Could not retrieve collection information");case 10:return p=Object(E.b)(G.baseFeeBps).plus(be.collection.royaltyBps),j=i.times(p).dividedToIntegerBy(1e4).plus(1),$(!0),f=new I.b(W),m=K.addressInfo.byte20.toLowerCase(),h=Object(x.fromBech32Address)(a).toLowerCase(),e.next=18,f.approveAllowanceIfRequired(h,m,P.c.getSDK());case 18:if(!(null===(O=e.sent)||void 0===O?void 0:O.id)){e.next=29;break}return he("Approve TX Submitted",{hash:O.id}),me(!0),e.prev=22,e.next=25,Object(I.k)(O.id);case 25:Be(!0);case 26:return e.prev=26,me(!1),e.finish(26);case 29:return g=new y.a(Math.random()).times(2147483647).decimalPlaces(0).toString(10),v=f.arkMessage("Execute",f.arkChequeHash({side:"Sell",token:{address:a,id:r},price:s,feeAmount:j,expiry:ee,nonce:g})),e.next=33,K.provider.wallet.sign(v);case 33:return w=e.sent,k=w.signature,B=w.publicKey,e.next=38,f.postTrade({publicKey:B,signature:k,collectionAddress:a,address:K.addressInfo.byte20.toLowerCase(),tokenId:r,side:"Sell",expiry:ee,nonce:g,price:s});case 38:N=e.sent,Object(I.j)("post trade",N),Se(!0),he("Successfully listed token #".concat(r,"!")),Fe.push("/arky/collections/".concat(Ee,"/").concat(Ie));case 43:case"end":return e.stop()}}),e,null,[[22,,26,29]])}))))},walletRequired:!0,children:"Sell NFT"})]}),Object(M.jsx)(p.a,{className:R.nftBox,children:be&&Object(M.jsx)(C.m,{className:R.nftCard,token:be,collectionAddress:Object(x.fromBech32Address)(Ee).toLowerCase(),dialog:!0})})]})]}),Object(M.jsx)(C.H,{className:R.dialogRoot,header:"Complete Listing",open:Z,onClose:function(){re||$(!1)},children:Object(M.jsx)(h.a,{className:R.dialogContent,children:Object(M.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(M.jsxs)(p.a,{display:"flex",alignItems:"center",marginBottom:4,position:"relative",children:[Object(M.jsx)(p.a,{className:k()(R.stepBar,(g={},Object(a.a)(g,R.stepBarFirstStepCompleted,ke),Object(a.a)(g,R.stepBarCompleted,ke&&Ce),g))}),Object(M.jsxs)(p.a,{className:k()(R.step,(v={},Object(a.a)(v,R.stepActive,!ke),Object(a.a)(v,R.stepCompleted,ke),v)),children:[ke?Object(M.jsx)(z,{}):Object(M.jsx)(M.Fragment,{children:"1"}),fe&&Object(M.jsx)(O.a,{className:R.progress,color:"inherit"})]}),Object(M.jsxs)(p.a,{display:"flex",flexDirection:"column",alignItems:"stretch",children:[Object(M.jsx)(C.ib,{className:R.stepLabel,children:"Approve Token"}),Object(M.jsx)(C.ib,{children:"Approve once, and never again. This step approves the token for trading and involves a one-off gas fee."})]})]}),Object(M.jsxs)(p.a,{display:"flex",alignItems:"center",children:[Object(M.jsx)(p.a,{className:k()(R.step,(w={},Object(a.a)(w,R.stepActive,!Ce&&ke),Object(a.a)(w,R.stepCompleted,Ce),w)),children:Ce?Object(M.jsx)(z,{}):Object(M.jsx)(M.Fragment,{children:"2"})}),Object(M.jsxs)(p.a,{display:"flex",flexDirection:"column",alignItems:"stretch",children:[Object(M.jsx)(C.ib,{className:R.stepLabel,children:"Confirm Listing"}),Object(M.jsx)(C.ib,{children:"Accept the signature request on your wallet so that we can begin processing your request."})]})]})]})})})]})})):Object(M.jsx)(M.Fragment,{})}}}]);
//# sourceMappingURL=14.36ae1504.chunk.js.map